<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kids Fun Alpha-Learn</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&family=Quicksand:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-gradient: linear-gradient(180deg, #e0f2fe 0%, #f0f9ff 100%);
            --card-bg: #ffffff;
            --text-main: #1e293b;
            --accent: #6366f1;
        }

        .dark-mode {
            --bg-gradient: linear-gradient(180deg, #0f172a 0%, #1e1b4b 100%);
            --card-bg: #1e293b;
            --text-main: #f8fafc;
            --accent: #818cf8;
        }

        .sunset-mode {
            --bg-gradient: linear-gradient(180deg, #ffedd5 0%, #fef2f2 100%);
            --card-bg: #fffaf5;
            --text-main: #431407;
            --accent: #f97316;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background: var(--bg-gradient);
            color: var(--text-main);
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
            transition: all 0.5s ease;
            height: 100dvh;
        }

        .kids-font { font-family: 'Fredoka', sans-serif; }
        
        .btn-squish {
            transition: all 0.15s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .btn-squish:active {
            transform: scale(0.9) translateY(4px);
        }

        @keyframes bubble {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-10px) scale(1.05); }
        }
        .bubble-animate {
            animation: bubble 3s ease-in-out infinite;
        }

        .listen-pulse {
            animation: pulse-ring 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse-ring {
            0% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(34, 197, 94, 0); }
            100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(12px);
            border: 3px solid rgba(255, 255, 255, 0.4);
            border-radius: 2.5rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
        }

        .dark-mode .glass-panel {
            background: rgba(30, 41, 59, 0.6);
            border: 3px solid rgba(255, 255, 255, 0.1);
        }

        .card-toy {
            background: var(--card-bg);
            border-radius: 3rem;
            box-shadow: 0 20px 0px rgba(0,0,0,0.05), 0 30px 60px rgba(0,0,0,0.1);
            border-bottom: 12px solid #e2e8f0;
            transition: transform 0.3s ease;
        }

        .dark-mode .card-toy { border-bottom-color: #0f172a; }

        .active-theme {
            transform: scale(1.3);
            box-shadow: 0 0 20px var(--accent);
            border: 3px solid white;
            z-index: 10;
        }

        .control-label {
            font-size: 0.65rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            opacity: 0.7;
            margin-bottom: 4px;
        }
    </style>
</head>
<body class="flex flex-col items-center p-4 overflow-hidden select-none">

    <!-- Top Score Bar -->
    <header class="w-full max-w-md flex justify-between items-center mb-4">
        <div class="glass-panel px-4 py-2 flex items-center gap-2 shadow-sm">
            <span class="text-xl">üìä</span>
            <span class="kids-font font-bold text-indigo-500" id="progressText">1/100</span>
        </div>
        <div class="glass-panel px-4 py-2 flex items-center gap-2 shadow-sm">
            <span class="text-2xl">‚≠ê</span>
            <span class="kids-font font-bold text-yellow-500 text-xl" id="starCount">0</span>
        </div>
    </header>

    <!-- Kid-Friendly Smart Dashboard -->
    <section class="w-full max-w-md glass-panel p-4 mb-6 grid grid-cols-3 gap-2">
        <!-- Magic Themes -->
        <div class="flex flex-col items-center border-r border-white/30">
            <div class="flex items-center gap-1 mb-1">
                <span class="text-xs">‚ú®</span>
                <span class="control-label">Magic</span>
            </div>
            <div class="flex gap-2 py-1">
                <button onclick="setTheme('day', this)" class="theme-btn active-theme w-8 h-8 bg-white rounded-full shadow-lg border-2 border-blue-100"></button>
                <button onclick="setTheme('dark', this)" class="theme-btn w-8 h-8 bg-indigo-950 rounded-full shadow-lg"></button>
                <button onclick="setTheme('sunset', this)" class="theme-btn w-8 h-8 bg-orange-400 rounded-full shadow-lg"></button>
            </div>
        </div>

        <!-- Speed Toggle (Rocket vs Turtle) -->
        <div class="flex flex-col items-center border-r border-white/30">
            <div class="flex items-center gap-1 mb-1">
                <span class="text-xs">üèéÔ∏è</span>
                <span class="control-label">Speed</span>
            </div>
            <button id="slowVoiceBtn" onclick="toggleSlowVoice()" class="btn-squish w-14 h-10 bg-white/60 rounded-full flex items-center justify-around px-2 shadow-inner overflow-hidden relative">
                <span id="speedIcon" class="text-2xl transition-all duration-300">üöÄ</span>
                <div id="speedIndicator" class="absolute bottom-1 w-1 h-1 bg-indigo-500 rounded-full hidden"></div>
            </button>
        </div>

        <!-- Grow/Shrink (Plant Icons) -->
        <div class="flex flex-col items-center">
            <div class="flex items-center gap-1 mb-1">
                <span class="text-xs">üå≥</span>
                <span class="control-label">Grow</span>
            </div>
            <div class="flex items-center gap-2">
                <button onclick="adjustFontSize(-1)" class="btn-squish w-9 h-9 bg-white/60 rounded-xl flex items-center justify-center text-xl shadow-sm">üå±</button>
                <button onclick="adjustFontSize(1)" class="btn-squish w-9 h-9 bg-white/60 rounded-xl flex items-center justify-center text-xl shadow-sm">üå≥</button>
            </div>
        </div>
    </section>

    <!-- Main Learning Toy -->
    <main class="card-toy w-full max-w-md p-8 relative flex flex-col items-center flex-1 max-h-[520px] justify-center">
        <div id="categoryBadge" class="absolute -top-4 bg-indigo-500 text-white px-6 py-2 rounded-full text-xs font-bold tracking-tighter uppercase shadow-xl kids-font">
            Ready to Play!
        </div>

        <div class="flex flex-col items-center justify-center w-full bubble-animate">
            <h1 id="mainWord" class="kids-font leading-none mb-4 transition-all duration-300 drop-shadow-sm">A</h1>
            <div class="h-8 flex items-center justify-center">
                <p id="feedbackText" class="text-sm font-bold opacity-30 italic">Tap a big button!</p>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="grid grid-cols-2 gap-6 w-full mt-8">
            <button onclick="playAudio()" class="btn-squish flex flex-col items-center justify-center bg-orange-400 text-white rounded-[2.5rem] py-6 shadow-[0_10px_0_#c2410c]">
                <div class="bg-white/20 p-4 rounded-full mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" /></svg>
                </div>
                <span class="kids-font font-bold uppercase text-base tracking-widest">Listen</span>
            </button>

            <button id="speakBtn" onclick="toggleSpeech()" class="btn-squish flex flex-col items-center justify-center bg-green-500 text-white rounded-[2.5rem] py-6 shadow-[0_10px_0_#15803d]">
                <div id="micIcon" class="bg-white/20 p-4 rounded-full mb-2 transition-transform">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" /></svg>
                </div>
                <span id="speakLabel" class="kids-font font-bold uppercase text-base tracking-widest">Say It</span>
            </button>
        </div>
    </main>

    <!-- Navigation -->
    <footer class="w-full max-w-md flex items-center gap-4 mt-8 mb-4">
        <button onclick="changeItem(-1)" class="btn-squish bg-white dark:bg-slate-800 text-gray-400 rounded-3xl p-6 shadow-lg border-b-4 border-gray-200 dark:border-slate-900">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="4" d="M15 19l-7-7 7-7" /></svg>
        </button>
        <button onclick="changeItem(1)" class="btn-squish flex-1 bg-indigo-600 text-white rounded-3xl py-6 kids-font font-bold text-2xl shadow-[0_10px_0_#312e81] tracking-wider uppercase">
            Next! ‚ûî
        </button>
    </footer>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 bg-indigo-900/60 backdrop-blur-xl hidden items-center justify-center z-50 p-6">
        <div id="modalContent" class="bg-white dark:bg-slate-800 rounded-[4rem] p-12 max-w-sm w-full text-center shadow-2xl scale-75 opacity-0 transition-all duration-500 border-b-[16px] border-indigo-200">
            <div class="text-8xl mb-6">üéà</div>
            <h2 class="kids-font text-5xl text-indigo-600 mb-2">WOW!</h2>
            <p id="modalMsg" class="text-2xl text-gray-500 mb-8 kids-font">You are a superstar!</p>
            <button onclick="closeModal()" class="btn-squish w-full bg-yellow-400 text-yellow-900 rounded-[2.5rem] py-7 kids-font font-bold text-2xl shadow-[0_10px_0_#b45309]">KEEP PLAYING!</button>
        </div>
    </div>

    <script>
        let items = [
            ...Array.from({length: 20}, (_, i) => ({ text: (i + 1).toString(), type: 'Number' })),
            ...Array.from('ABCDEFGHIJKLMNOPQRSTUVWXYZ').map(l => ({ text: l, type: 'Big Letter' })), 
            ...Array.from('abcdefghijklmnopqrstuvwxyz').map(l => ({ text: l, type: 'Small Letter' })), 
            ...['Apple', 'Ball', 'Cat', 'Dog', 'Egg', 'Fish', 'Goat', 'Hat', 'Ice', 'Jar', 'Kite', 'Lion', 'Moon', 'Nest', 'Owl', 'Pig', 'Queen', 'Rain', 'Sun', 'Tree', 'Up', 'Van', 'Web', 'Xylophone', 'Yo-yo', 'Zebra', 'Red', 'Blue', 'Green', 'Yellow', 'Pink', 'Purple', 'Orange', 'One', 'Two', 'Three', 'Four', 'Five', 'Bird', 'Bear', 'Star', 'Cake', 'Milk', 'Book', 'Fish', 'Frog', 'Duck'].map(w => ({ text: w, type: 'Word' }))
        ];
        
        function shuffle(a) { 
            for (let i = a.length - 1; i > 0; i--) { 
                const j = Math.floor(Math.random() * (i + 1)); 
                [a[i], a[j]] = [a[j], a[i]]; 
            } return a; 
        }
        
        items = shuffle(items);

        let currentIndex = parseInt(localStorage.getItem('alphaLearn_index')) || 0;
        let score = parseInt(localStorage.getItem('alphaLearn_stars')) || 0;
        let fontScale = 1.0;
        let isSlowVoice = false;
        let isListening = false;
        const synth = window.speechSynthesis;
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        let recognition = null;

        const mainWord = document.getElementById('mainWord');
        const feedback = document.getElementById('feedbackText');
        const progress = document.getElementById('progressText');
        const starCount = document.getElementById('starCount');
        const badge = document.getElementById('categoryBadge');
        const speakBtn = document.getElementById('speakBtn');
        const speakLabel = document.getElementById('speakLabel');
        const micIcon = document.getElementById('micIcon');
        const modal = document.getElementById('successModal');
        const modalContent = document.getElementById('modalContent');

        if (SpeechRecognition) {
            recognition = new SpeechRecognition();
            recognition.lang = 'en-US';
            recognition.onstart = () => { isListening = true; updateMicUI(); };
            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript.toLowerCase().trim();
                const target = items[currentIndex].text.toLowerCase();
                if (transcript.includes(target)) { 
                    recognition.stop(); 
                    handleSuccess(); 
                } else { 
                    feedback.textContent = `Try saying "${items[currentIndex].text}"`; 
                }
            };
            recognition.onerror = () => stopSpeech();
            recognition.onend = () => { isListening = false; updateMicUI(); };
        }

        function updateDisplay() {
            const item = items[currentIndex];
            mainWord.textContent = item.text;
            badge.textContent = item.type;
            
            const badgeColors = { 'Number': '#f59e0b', 'Big Letter': '#6366f1', 'Small Letter': '#8b5cf6', 'Word': '#ec4899' };
            badge.style.backgroundColor = badgeColors[item.type] || '#6366f1';

            progress.textContent = `${currentIndex + 1}/${items.length}`;
            starCount.textContent = score;
            
            const colors = ['#4F46E5', '#EC4899', '#10B981', '#F59E0B', '#8B5CF6', '#EF4444', '#06B6D4', '#F43F5E'];
            mainWord.style.color = colors[currentIndex % colors.length];
            
            const isLongWord = item.text.length > 5;
            const baseSize = window.innerWidth < 640 ? (isLongWord ? 4 : 7) : (isLongWord ? 6 : 9);
            mainWord.style.fontSize = `${fontScale * baseSize}rem`;
            
            feedback.textContent = "Tap Listen or Say It!";
            localStorage.setItem('alphaLearn_index', currentIndex);
            localStorage.setItem('alphaLearn_stars', score);
        }

        function playAudio() {
            if (synth.speaking) synth.cancel();
            const utter = new SpeechSynthesisUtterance(items[currentIndex].text);
            utter.rate = isSlowVoice ? 0.35 : 0.85;
            utter.pitch = 1.35;
            synth.speak(utter);
        }

        function toggleSpeech() { 
            if (!recognition) return; 
            isListening ? recognition.stop() : recognition.start(); 
        }

        function updateMicUI() {
            if (isListening) {
                micIcon.classList.add('listen-pulse', 'scale-125');
                speakLabel.textContent = "listening...";
                speakBtn.style.backgroundColor = "#22c55e";
            } else {
                micIcon.classList.remove('listen-pulse', 'scale-125');
                speakLabel.textContent = "Say It";
                speakBtn.style.backgroundColor = ""; 
            }
        }

        function stopSpeech() { if (recognition) recognition.stop(); isListening = false; updateMicUI(); }

        function handleSuccess() {
            score++;
            updateDisplay();
            const cheers = ["Great job!", "You got it!", "Amazing!", "Super!", "Fantastic!", "High five!"];
            synth.speak(new SpeechSynthesisUtterance(cheers[Math.floor(Math.random()*cheers.length)]));
            modal.classList.replace('hidden', 'flex');
            setTimeout(() => { 
                modalContent.classList.replace('scale-75', 'scale-100'); 
                modalContent.classList.replace('opacity-0', 'opacity-100'); 
            }, 50);
        }

        function closeModal() {
            modalContent.classList.replace('scale-100', 'scale-75');
            modalContent.classList.replace('opacity-100', 'opacity-0');
            setTimeout(() => { modal.classList.replace('flex', 'hidden'); changeItem(1); }, 200);
        }

        function changeItem(dir) { 
            stopSpeech(); 
            currentIndex = (currentIndex + dir + items.length) % items.length; 
            updateDisplay(); 
        }

        function adjustFontSize(dir) {
            fontScale = Math.max(0.6, Math.min(1.4, fontScale + (dir * 0.1)));
            updateDisplay();
        }

        function toggleSlowVoice() {
            isSlowVoice = !isSlowVoice;
            const icon = document.getElementById('speedIcon');
            const btn = document.getElementById('slowVoiceBtn');
            const indicator = document.getElementById('speedIndicator');
            
            icon.textContent = isSlowVoice ? 'üê¢' : 'üöÄ';
            btn.classList.toggle('bg-orange-100', isSlowVoice);
            indicator.classList.toggle('hidden', !isSlowVoice);
        }

        function setTheme(theme, btn) {
            document.body.className = "flex flex-col items-center p-4 overflow-hidden select-none";
            if (theme === 'dark') document.body.classList.add('dark-mode');
            if (theme === 'sunset') document.body.classList.add('sunset-mode');
            document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active-theme'));
            btn.classList.add('active-theme');
        }

        window.onload = updateDisplay;
    </script>
</body>
</html>
